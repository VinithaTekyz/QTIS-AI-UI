<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Quasar + Vue AI Rewrite</title>
  <!-- Quasar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/quasar@2.17.4/dist/quasar.prod.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body class="q-pa-md">
  <div id="q-app">
    <img src="https://res.cloudinary.com/dn7ejk1ei/image/upload/v1757864421/image_2_1_prdwfg.png" alt="WhatsApp Video 2025 09 14 at 20.38.55" border="0">
    <div class="q-pa-md q-gutter-sm">
      <a href="http://3.80.147.19/invoice_FREELANCE001_Mon%20Oct%2006%202025.pdf" download>Download</a>
      <a href="http://3.80.147.19/invoice_001_1759759530376.docx" download>Download</a>

      <!-- Entities list -->
      <div v-if="parsedEntities.length === 0">No entities found. Please try again.</div>
      <div v-for="(entity, index) in parsedEntities" :key="index"
        class="q-mb-sm row items-center no-wrap justify-between"
        style="border: 0.1px solid #808080b0; padding: 8px; border-radius: 10px;">
        <div class="row items-center no-wrap">
          <div class="q-mt-sm" style="margin-right: 10px;">
            <q-icon name="today" />
          </div>
          <div>
            <q-badge transparent style="background: #bdddfd52; border-color: #1976d2; color: #1976d2;"
              class="q-mr-sm">{{
              entity.type }}</q-badge>
            <br />
            <span v-if="entity.type === 'users'">
              <template v-if="entity.fields.firstName || entity.fields.lastName">
                {{ entity.fields.firstName || "" }} {{ entity.fields.lastName || "" }}
              </template>
              <template v-else>
                New User
              </template>
              <div>
                <small style="color: #555;">{{ entity.fields.email || "" }}</small>
              </div>
            </span>
            <span v-else-if="entity.type === 'clients'">
              <template v-if="entity.fields.firstName || entity.fields.lastName">
                <b>{{ entity.fields.firstName || '' }} {{ entity.fields.lastName || '' }}</b>
              </template>
              <template v-else>
                <b>New Client</b>
              </template>
            </span>
            <span v-else-if="entity.type === 'cases'">
              <b>New Case - {{entity.fields.caseNumber || 'New Case'}}</b>
            </span>
            <span v-else-if="entity.type === 'department'">
              Department: <b>{{ entity.fields.name || 'New Department' }}</b>
            </span>
            <span v-else-if="entity.type === 'notepad'">
              Notes: <b>{{entity.fields.notes.substring(0, 30)}}...</b>
            </span>
          </div>
        </div>
        <!-- Create Button -->
        <div class="q-mt-sm">
          <!-- <q-btn round color="primary" icon="add" size="sm" /> -->
          <q-btn round color="green" icon="task_alt" size="sm" />
          
        </div>
      </div>
    </div>

    <q-editor v-model="editor" :definitions="editorDefinitions" :toolbar="editorToolbar" min-height="5rem">
      <template v-slot:rewrite="scope">
        <q-btn v-bind="scope.btnProps" :disable="loading" class="relative-position">
          <q-icon name="auto_awesome" v-if="!loading" />
          <q-spinner-dots size="16px" color="primary" v-else />
        </q-btn>
      </template>
    </q-editor>

    <!-- AI Rewrite Dialog -->
    <q-dialog v-model="showDialog" persistent>
      <q-card style="min-width: 350px; max-width: 600px;">
        <q-card-section>
          <div class="text-h6">AI Rewrite</div>
        </q-card-section>

        <q-separator />

        <q-card-section>
          <div v-if="loading" class="row justify-center q-my-md">
            <q-spinner-dots size="2em" color="primary" />
          </div>
          <div v-else v-html="suggestedText"></div>
        </q-card-section>

        <q-separator />

        <q-card-actions align="right">
          <q-btn flat label="Cancel" color="secondary" v-close-popup />
          <q-btn flat label="Apply" color="primary" @click="applySuggestion" />
        </q-card-actions>
      </q-card>
    </q-dialog>
  </div>
  </div>

  <!-- Vue -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <!-- Quasar -->
  <script src="https://cdn.jsdelivr.net/npm/quasar@2.17.4/dist/quasar.umd.prod.js"></script>

  <script>
    const { createApp } = Vue;
    const { Quasar } = window;

    createApp({
      data() {
        return {
          editor: '',
          showDialog: false,
          suggestedText: '',
          loading: false,
          editorToolbar: [
            ['bold', 'italic', 'underline'],
            ['rewrite']
          ],
          parsedEntities: [
            {
              "type": "users",
              "fields": {
                "firstName": "vicky",
                "lastName": "kumar",
                "email": "vignesh@gmail.com"
              }
            },
            {
              "type": "clients",
              "fields": {
                "count": 2
              }
            }
          ]
        }
      },
      computed: {
        editorDefinitions() {
          return {
            rewrite: {
              tip: 'Rewrite Text',
              label: 'Rewrite with AI',
              round: true,
              color: 'primary',
              handler: () => {
                this.showDialog = true;
                this.loading = true;
                this.suggestedText = '';
                this.getAISuggestions();
              }
            }
          }
        }
      },
      methods: {
        async getAISuggestions() {
          try {
            // Mock API delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            this.suggestedText = "<b>Improved:</b><br> This is the AI rewritten version of your text ✨";
          } catch (error) {
            this.suggestedText = "❌ Failed to get AI suggestion.";
          } finally {
            this.loading = false;
          }
        },
        applySuggestion() {
          if (this.suggestedText) {
            this.editor = this.suggestedText;
          }
          this.showDialog = false;
        }
      }
    })
      .use(Quasar)   <!-- ✅ Ensure Quasar is mounted -->
      .mount("#q-app");
  </script>
</body>

</html>